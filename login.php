<?php	function query_db($userstring, $pswstring) {	include('db_login.php'); //connection details	require_once('DB.php'); //pear DB	$connection = DB::connect("mysql://$db_username:$db_password@$db_hostname/$db_dbname");		if(DB::isError($connection)){ // check for connection errors		die ("Could not connect to the database: <br />". DB::errorMessage($connection));	}	if(get_magic_quotes_gpc()){ //guard against SQL injection		$qstring = stripslashes($qstring);	}	$userstring = mysql_real_escape_string($userstring);	$pswstring = mysql_real_escape_string($pswstring);	$query = "SELECT username, password FROM user               WHERE username = '$userstring' and password = '$pswstring'";  //build the query		$result = $connection->query($query);	if(DB::isError($result)){		die("Could not query the database:<br />".$query." ".DB::errorMessage($result));	}	else if($result->numRows() == 1){		header('Location: search.php');		}	else{		$connection->disconnect();		header('Location: invalidlogin.php');		}	$connection->disconnect();}?><html><head>	<title>Login homepage</title></head><body><?php$errormessage = false;$self = htmlentities($_SERVER['PHP_SELF']);if(isset($_GET["username"]) && isset($_GET['password'])){$username = htmlentities($_GET["username"]);$password = htmlentities($_GET["password"]);if($username != NULL && $password != NULL){	query_db($username, $password);}else{	$errormessage = true;	goto login;}}else{login:	echo ('	<form action = "'.$self.'" method = "GET">		<label>username:			<input type = "text" name = "username"/>		</label>		<label>password:			<input type = "text" name = "password"/>		</label>		<input type = "submit" value = "login" />	</form>	');	if($errormessage == true){		echo '<script type="text/javascript">';       	 	echo 'alert("Please enter a username and password before signing in")';        	echo '</script>';	}}?></body></html>